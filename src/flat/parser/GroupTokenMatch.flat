package flat/parser

import flat/datastruct/HashMap
import flat/compiler/models/Token

data class extends TokenMatch {
  visible TokenMatch[] tokenMatches

  override public getValue(String label) -> String {
    let values = this.getValues(label)

    return values.first
  }

  override public getValues(String label) -> String[] {
    return tokenMatches.flatMap({ _.getValues(label) })
  }

  override public getMatch<Type extends TokenMatch>(String label) -> Type {
    let matches = this.getMatches(label)

    return matches.first
  }

  override public getMatches<Type extends TokenMatch>(String label) -> Type[] {
    let array = Type[]

    if (this.label == label) {
      array.add(this)
    }

    tokenMatches
      :forEach({ array.addAll(_.getMatches(label)) })
      .filter({ _.label == label })
      :forEach({ array.add(_) })

    return array
  }
}