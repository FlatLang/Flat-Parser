package flat/parser

import flat/datastruct/HashMap
import flat/parser/Parser
import flat/annotations/VisibleModifier
import flat/annotations/PublicModifier
import flat/annotations/PrivateModifier
import flat/annotations/LetModifier
import flat/annotations/VarModifier
import flat/ast/FileNode
import flat/ast/PackageNode
import flat/compiler/models/Token
import flat/io/File

testable class {
  test `returns no tokens on successful match`() {
    let pattern = PreconditionTokenPattern([LetModifier.class])

    let context = ParseContext(
      annotations: [LetModifier(aliasUsed: "let")]
    )

    let matcher = pattern.getMatcher()
    let result = matcher.match(Token(value: "package", type: Token.Type.IDENTIFIER), context)

    expect(result?.tokens).toBe(Array())
  }

  test `returns null on unsuccessful match`() {
    let pattern = PreconditionTokenPattern([LetModifier.class])

    let context = ParseContext(
      annotations: [VarModifier(aliasUsed: "var")]
    )

    let matcher = pattern.getMatcher()
    let result = matcher.match(Token(value: "package", type: Token.Type.IDENTIFIER), context)

    expect(result).toBe(null)
  }
}